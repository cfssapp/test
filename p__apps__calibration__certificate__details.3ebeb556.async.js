(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[223],{51203:function(H){H.exports={listContent:"listContent___F9LE6",description:"description___S7dDJ",extra:"extra___GRe7Q"}},21813:function(H){H.exports={standardList:"standardList___15dvZ",headerInfo:"headerInfo___2UjMI",listContent:"listContent___3P9oR",listContentItem:"listContentItem___2XB2X",extraContentSearch:"extraContentSearch___ye7w6",listCard:"listCard___32_Cq",standardListForm:"standardListForm___AY1Cw",formResult:"formResult___2YPn6",listItemMetaTitle:"listItemMetaTitle___2ooQk",listItemExtra:"listItemExtra___FX3UR",selfTrigger:"selfTrigger___3-287",activitiesList:"activitiesList___1K_NH",username:"username___2Spc0",event:"event___1RC9Q",pageHeaderContent:"pageHeaderContent___1h5Sz",avatar:"avatar___1RUNU",content:"content___1g9gn",contentTitle:"contentTitle___nCmUH",extraContent:"extraContent___Ikiwk",statItem:"statItem___18iyT",members:"members___1kUEm",member:"member___1lEil",projectList:"projectList___3dm_2",cardTitle:"cardTitle___3p4ce",projectGrid:"projectGrid___1p_7a",projectItemContent:"projectItemContent___2gIkI",datetime:"datetime___2lR95",activeCard:"activeCard___1qRni",headerList:"headerList___1Z35I",stepDescription:"stepDescription___39kzL"}},97432:function(){},19422:function(){},20210:function(H,B,a){"use strict";a.r(B),a.d(B,{Current1Cert:function(){return M},default:function(){return d}});var b=a(58024),W=a(39144),s=a(54421),te=a(38272),ae=a(57663),ue=a(71577),ge=a(95300),be=a(7277),Te=a(98858),k=a(4914),Ie=a(71748),X=a(33860),G=a(8870),oe=a(2824),U=a(67294),I=a(64335),Pe=a(75362),xe=a(49101),Ze=a(97363),Ee=a(71194),Me=a(57016),h=a(43185),l=a(94412),x=a(57106),o=a(99683),g=a(9715),$=a(82482),L=a(47673),ne=a(4107),re=a(30381),ie=a.n(re),i=a(21813),e=a.n(i),n=a(84391),r=a(98005),c=a.n(r),t=a(85893),C=ne.Z.TextArea,y={labelCol:{span:7},wrapperCol:{span:13}},f=function(u){var P=$.Z.useForm(),Y=(0,oe.Z)(P,1),S=Y[0],R=u.done,V=u.visible,_=u.current,q=u.onDone,se=u.onCancel,ye=u.onSubmit;(0,U.useEffect)(function(){S&&!V&&S.resetFields()},[u.visible]),(0,U.useEffect)(function(){_&&S.setFieldsValue((0,G.Z)((0,G.Z)({},_),{},{createdAt:_.createdAt?ie()(_.createdAt):null}))},[u.current]);var le=function(){!S||S.submit()},fe=[],ee=function(Oe){ye&&(console.log("2. imagevalues: "+fe),Oe.imagesupload_id=fe,ye(Oe))},ve=R?{footer:null,onCancel:q}:{okText:"Save",onOk:le,onCancel:se},Q=function(){if(R)return(0,t.jsx)(o.ZP,{status:"success",title:"Done",extra:(0,t.jsx)(ue.Z,{type:"primary",onClick:q,children:"Okay"}),className:e().formResult});var Oe={name:"imagefile",action:"https://antapi.pythonanywhere.com/calibration/comment/image/",beforeUpload:function(ce){return new Promise(function(he){var Ce=(ce.size/1024/1024).toFixed(1),je;if(Ce<1)je=1;else if(Ce<2)je=.6;else if(Ce<5)je=.4;else return new Promise(function(Ue,De){De({msg:"Image not larger than 10m"})});new(c())(ce,{quality:je,success:function(De){he(De)}})})},headers:{Authorization:"JWT "+localStorage.getItem("access_token")},onChange:function(ce){var he=ce.file,Ce=ce.fileList;he.status!=="uploading"&&(console.log(he,Ce),console.log(he.response.id),fe.push(he.response.id),console.log("2. imagevalues: "+fe))}};return(0,t.jsxs)($.Z,(0,G.Z)((0,G.Z)({},y),{},{form:S,onFinish:ee,children:[(0,t.jsx)($.Z.Item,{label:"Upload",name:"uploadimages",children:(0,t.jsx)(l.Z,(0,G.Z)((0,G.Z)({},Oe),{},{children:(0,t.jsx)(ue.Z,{icon:(0,t.jsx)(n.Z,{}),children:"Click to Upload"})}))}),(0,t.jsx)($.Z.Item,{name:"content",label:"Content",rules:[{message:"Minimum 5 characters",min:5}],children:(0,t.jsx)(C,{rows:4,placeholder:"Minimum 5 characters"})})]}))};return(0,t.jsx)(Me.Z,(0,G.Z)((0,G.Z)({title:R?null:"".concat(_?"Edit":"Write"," a commment..."),className:e().standardListForm,width:640,destroyOnClose:!0,visible:V},ve),{},{children:Q()}))},v=f,E=a(73935),p=a(94233),D=a(51890),T=a(49111),m=a(19650),Z=a(12968),j=a(62462),O=a(51203),me=a.n(O);function w(F){var u=F.jsonImage,P=u.map(function(Y){return(0,t.jsx)(j.Z,{width:50,src:Y.imagefile})});return P}function K(F){var u=F.jsonImage;return u.length===0?null:u.length!==0?(0,t.jsx)(j.Z.PreviewGroup,{children:(0,t.jsx)(m.Z,{size:"middle",children:(0,t.jsx)(w,{jsonImage:u})})}):(0,t.jsx)("h1",{children:"Error."})}var A=function(u){var P=u.data,Y=P.content,S=P.name,R=P.created,V=P.user,_=P.href,q=P.image;return(0,t.jsxs)("div",{className:me().listContent,children:[(0,t.jsx)("div",{className:me().description,children:Y}),(0,t.jsx)(K,{jsonImage:q}),(0,t.jsxs)("div",{className:me().extra,children:[(0,t.jsx)(D.C,{src:V.avatar,size:"small"}),(0,t.jsx)("a",{href:_,children:V.user_name}),(0,t.jsx)("em",{children:R})]})]})},z=A,M=function(u){var P=(0,U.useRef)(null),Y=u.loading,S=u.dispatch,R=u.Current4Cert.Current5Cert,V=(0,U.useState)(!1),_=(0,oe.Z)(V,2),q=_[0],se=_[1],ye=(0,U.useState)(!1),le=(0,oe.Z)(ye,2),fe=le[0],ee=le[1],ve=(0,U.useState)(void 0),Q=(0,oe.Z)(ve,2),pe=Q[0],Oe=Q[1];(0,U.useEffect)(function(){S({type:"Current4Cert/beforefetch",payload:{}}),S({type:"Current4Cert/fetch",payload:{}})},[1]);var Be=function(){ee(!0),Oe(void 0)},ce=function(){if(P.current){var J=(0,E.findDOMNode)(P.current);setTimeout(function(){return J.blur()},0)}},he=function(){ce(),se(!1),ee(!1)},Ce=function(){ce(),ee(!1)},je=function(J){var N=localStorage.getItem("topic_id"),Le=pe?pe.id:N;ce(),se(!0),S({type:"Current4Cert/submit",payload:(0,G.Z)({id:Le},J)})},Ue={showSizeChanger:!1,showQuickJumper:!1,pageSize:5},De=function(J){var N=J.currentTitle;return(0,t.jsx)("div",{children:N.certificate_id})},Se=function(J){var N=J.currentUser2,Le=N&&Object.keys(N).length;if(!Le)return(0,t.jsx)(X.Z,{paragraph:{rows:1},active:!0});var Ae=N.user?N.user.user_name:N.user;return console.log(Ae),(0,t.jsx)(I.Z.Consumer,{children:function(_e){var Ne=_e.isMobile;return(0,t.jsxs)(k.Z,{className:e().headerList,size:"small",column:Ne?1:2,children:[(0,t.jsx)(k.Z.Item,{label:"Author",children:Ae}),(0,t.jsx)(k.Z.Item,{label:"Customer",children:N.customer}),(0,t.jsx)(k.Z.Item,{label:"Instrument",children:N.instrument}),(0,t.jsx)(k.Z.Item,{label:"Updated",children:N.updated})]})}})},Re=function(J){var N=J.currentExtra;return(0,t.jsxs)("div",{className:e().extraContent,children:[(0,t.jsx)("div",{className:e().statItem,children:(0,t.jsx)(be.Z,{title:"Comment",value:N.post_count})}),(0,t.jsx)("div",{className:e().statItem,children:(0,t.jsx)(be.Z,{title:"View",value:N.views})})]})};return(0,t.jsxs)("div",{children:[(0,t.jsx)(Pe.ZP,{title:(0,t.jsx)(De,{currentTitle:R}),onBack:function(){return window.history.back()},content:(0,t.jsx)(Se,{currentUser2:R}),extraContent:(0,t.jsx)(Re,{currentExtra:R}),children:(0,t.jsxs)(W.Z,{children:[(0,t.jsxs)(ue.Z,{type:"dashed",style:{width:"100%",marginBottom:8},onClick:Be,ref:P,children:[(0,t.jsx)(xe.Z,{}),"Write a commment..."]}),(0,t.jsx)(te.ZP,{size:"large",loading:Y,pagination:Ue,rowKey:"id",itemLayout:"vertical",dataSource:R.comments,renderItem:function(J){return(0,t.jsxs)(te.ZP.Item,{children:[(0,t.jsx)(te.ZP.Item.Meta,{}),(0,t.jsx)(z,{data:J})]},J.id)}})]})}),(0,t.jsx)(v,{done:q,current:pe,visible:fe,onDone:he,onCancel:Ce,onSubmit:je})]})},d=(0,Ze.$j)(function(F){var u=F.Current4Cert,P=F.loading;return{Current4Cert:u,loading:P.models.Current4Cert}})(M)},39144:function(H,B,a){"use strict";a.d(B,{Z:function(){return Me}});var b=a(96156),W=a(22122),s=a(67294),te=a(94184),ae=a.n(te),ue=a(98423),ge=a(65632),be=function(h,l){var x={};for(var o in h)Object.prototype.hasOwnProperty.call(h,o)&&l.indexOf(o)<0&&(x[o]=h[o]);if(h!=null&&typeof Object.getOwnPropertySymbols=="function")for(var g=0,o=Object.getOwnPropertySymbols(h);g<o.length;g++)l.indexOf(o[g])<0&&Object.prototype.propertyIsEnumerable.call(h,o[g])&&(x[o[g]]=h[o[g]]);return x},Te=function(l){var x=l.prefixCls,o=l.className,g=l.hoverable,$=g===void 0?!0:g,L=be(l,["prefixCls","className","hoverable"]);return s.createElement(ge.C,null,function(ne){var re=ne.getPrefixCls,ie=re("card",x),i=ae()("".concat(ie,"-grid"),o,(0,b.Z)({},"".concat(ie,"-grid-hoverable"),$));return s.createElement("div",(0,W.Z)({},L,{className:i}))})},k=Te,Ie=function(h,l){var x={};for(var o in h)Object.prototype.hasOwnProperty.call(h,o)&&l.indexOf(o)<0&&(x[o]=h[o]);if(h!=null&&typeof Object.getOwnPropertySymbols=="function")for(var g=0,o=Object.getOwnPropertySymbols(h);g<o.length;g++)l.indexOf(o[g])<0&&Object.prototype.propertyIsEnumerable.call(h,o[g])&&(x[o[g]]=h[o[g]]);return x},X=function(l){return s.createElement(ge.C,null,function(x){var o=x.getPrefixCls,g=l.prefixCls,$=l.className,L=l.avatar,ne=l.title,re=l.description,ie=Ie(l,["prefixCls","className","avatar","title","description"]),i=o("card",g),e=ae()("".concat(i,"-meta"),$),n=L?s.createElement("div",{className:"".concat(i,"-meta-avatar")},L):null,r=ne?s.createElement("div",{className:"".concat(i,"-meta-title")},ne):null,c=re?s.createElement("div",{className:"".concat(i,"-meta-description")},re):null,t=r||c?s.createElement("div",{className:"".concat(i,"-meta-detail")},r,c):null;return s.createElement("div",(0,W.Z)({},ie,{className:e}),n,t)})},G=X,oe=a(41046),U=a(71230),I=a(15746),Pe=a(97647),xe=function(h,l){var x={};for(var o in h)Object.prototype.hasOwnProperty.call(h,o)&&l.indexOf(o)<0&&(x[o]=h[o]);if(h!=null&&typeof Object.getOwnPropertySymbols=="function")for(var g=0,o=Object.getOwnPropertySymbols(h);g<o.length;g++)l.indexOf(o[g])<0&&Object.prototype.propertyIsEnumerable.call(h,o[g])&&(x[o[g]]=h[o[g]]);return x};function Ze(h){var l=h.map(function(x,o){return s.createElement("li",{style:{width:"".concat(100/h.length,"%")},key:"action-".concat(o)},s.createElement("span",null,x))});return l}var Ee=function(l){var x,o,g=s.useContext(ge.E_),$=g.getPrefixCls,L=g.direction,ne=s.useContext(Pe.Z),re=function(ve){var Q;(Q=l.onTabChange)===null||Q===void 0||Q.call(l,ve)},ie=function(){var ve;return s.Children.forEach(l.children,function(Q){Q&&Q.type&&Q.type===k&&(ve=!0)}),ve},i=l.prefixCls,e=l.className,n=l.extra,r=l.headStyle,c=r===void 0?{}:r,t=l.bodyStyle,C=t===void 0?{}:t,y=l.title,f=l.loading,v=l.bordered,E=v===void 0?!0:v,p=l.size,D=l.type,T=l.cover,m=l.actions,Z=l.tabList,j=l.children,O=l.activeTabKey,me=l.defaultActiveTabKey,w=l.tabBarExtraContent,K=l.hoverable,A=l.tabProps,z=A===void 0?{}:A,M=xe(l,["prefixCls","className","extra","headStyle","bodyStyle","title","loading","bordered","size","type","cover","actions","tabList","children","activeTabKey","defaultActiveTabKey","tabBarExtraContent","hoverable","tabProps"]),d=$("card",i),F=C.padding===0||C.padding==="0px"?{padding:24}:void 0,u=s.createElement("div",{className:"".concat(d,"-loading-block")}),P=s.createElement("div",{className:"".concat(d,"-loading-content"),style:F},s.createElement(U.Z,{gutter:8},s.createElement(I.Z,{span:22},u)),s.createElement(U.Z,{gutter:8},s.createElement(I.Z,{span:8},u),s.createElement(I.Z,{span:15},u)),s.createElement(U.Z,{gutter:8},s.createElement(I.Z,{span:6},u),s.createElement(I.Z,{span:18},u)),s.createElement(U.Z,{gutter:8},s.createElement(I.Z,{span:13},u),s.createElement(I.Z,{span:9},u)),s.createElement(U.Z,{gutter:8},s.createElement(I.Z,{span:4},u),s.createElement(I.Z,{span:3},u),s.createElement(I.Z,{span:16},u))),Y=O!==void 0,S=(0,W.Z)((0,W.Z)({},z),(x={},(0,b.Z)(x,Y?"activeKey":"defaultActiveKey",Y?O:me),(0,b.Z)(x,"tabBarExtraContent",w),x)),R,V=Z&&Z.length?s.createElement(oe.Z,(0,W.Z)({size:"large"},S,{className:"".concat(d,"-head-tabs"),onChange:re}),Z.map(function(ee){return s.createElement(oe.Z.TabPane,{tab:ee.tab,disabled:ee.disabled,key:ee.key})})):null;(y||n||V)&&(R=s.createElement("div",{className:"".concat(d,"-head"),style:c},s.createElement("div",{className:"".concat(d,"-head-wrapper")},y&&s.createElement("div",{className:"".concat(d,"-head-title")},y),n&&s.createElement("div",{className:"".concat(d,"-extra")},n)),V));var _=T?s.createElement("div",{className:"".concat(d,"-cover")},T):null,q=s.createElement("div",{className:"".concat(d,"-body"),style:C},f?P:j),se=m&&m.length?s.createElement("ul",{className:"".concat(d,"-actions")},Ze(m)):null,ye=(0,ue.Z)(M,["onTabChange"]),le=p||ne,fe=ae()(d,(o={},(0,b.Z)(o,"".concat(d,"-loading"),f),(0,b.Z)(o,"".concat(d,"-bordered"),E),(0,b.Z)(o,"".concat(d,"-hoverable"),K),(0,b.Z)(o,"".concat(d,"-contain-grid"),ie()),(0,b.Z)(o,"".concat(d,"-contain-tabs"),Z&&Z.length),(0,b.Z)(o,"".concat(d,"-").concat(le),le),(0,b.Z)(o,"".concat(d,"-type-").concat(D),!!D),(0,b.Z)(o,"".concat(d,"-rtl"),L==="rtl"),o),e);return s.createElement("div",(0,W.Z)({},ye,{className:fe}),R,_,q,se)};Ee.Grid=k,Ee.Meta=G;var Me=Ee},58024:function(H,B,a){"use strict";var b=a(43673),W=a.n(b),s=a(97432),te=a.n(s),ae=a(18106),ue=a(13062),ge=a(89032)},15746:function(H,B,a){"use strict";var b=a(21584);B.Z=b.Z},89032:function(H,B,a){"use strict";var b=a(43673),W=a.n(b),s=a(6999)},98858:function(H,B,a){"use strict";var b=a(43673),W=a.n(b),s=a(19422),te=a.n(s)},71230:function(H,B,a){"use strict";var b=a(92820);B.Z=b.Z},13062:function(H,B,a){"use strict";var b=a(43673),W=a.n(b),s=a(6999)},98005:function(H){/*!
 * Compressor.js v1.0.7
 * https://fengyuanchen.github.io/compressorjs
 *
 * Copyright 2018-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2020-11-28T07:13:17.754Z
 */(function(B,a){H.exports=a()})(this,function(){"use strict";function B(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function a(i,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(i,r.key,r)}}function b(i,e,n){return e&&a(i.prototype,e),n&&a(i,n),i}function W(i,e,n){return e in i?Object.defineProperty(i,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):i[e]=n,i}function s(){return s=Object.assign||function(i){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=n[r])}return i},s.apply(this,arguments)}function te(i,e){var n=Object.keys(i);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(i);e&&(r=r.filter(function(c){return Object.getOwnPropertyDescriptor(i,c).enumerable})),n.push.apply(n,r)}return n}function ae(i){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?te(Object(n),!0).forEach(function(r){W(i,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):te(Object(n)).forEach(function(r){Object.defineProperty(i,r,Object.getOwnPropertyDescriptor(n,r))})}return i}function ue(i,e,n){return n={path:e,exports:{},require:function(r,c){return ge(r,c==null?n.path:c)}},i(n,n.exports),n.exports}function ge(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var be=ue(function(i){typeof window!="undefined"&&function(e){var n=e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype,r=e.Blob&&function(){try{return Boolean(new Blob)}catch(f){return!1}}(),c=r&&e.Uint8Array&&function(){try{return new Blob([new Uint8Array(100)]).size===100}catch(f){return!1}}(),t=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||e.MSBlobBuilder,C=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,y=(r||t)&&e.atob&&e.ArrayBuffer&&e.Uint8Array&&function(f){var v,E,p,D,T,m,Z,j,O;if(v=f.match(C),!v)throw new Error("invalid data URI");for(E=v[2]?v[1]:"text/plain"+(v[3]||";charset=US-ASCII"),p=!!v[4],D=f.slice(v[0].length),p?T=atob(D):T=decodeURIComponent(D),m=new ArrayBuffer(T.length),Z=new Uint8Array(m),j=0;j<T.length;j+=1)Z[j]=T.charCodeAt(j);return r?new Blob([c?Z:m],{type:E}):(O=new t,O.append(m),O.getBlob(E))};e.HTMLCanvasElement&&!n.toBlob&&(n.mozGetAsFile?n.toBlob=function(f,v,E){var p=this;setTimeout(function(){E&&n.toDataURL&&y?f(y(p.toDataURL(v,E))):f(p.mozGetAsFile("blob",v))})}:n.toDataURL&&y&&(n.msToBlob?n.toBlob=function(f,v,E){var p=this;setTimeout(function(){(v&&v!=="image/png"||E)&&n.toDataURL&&y?f(y(p.toDataURL(v,E))):f(p.msToBlob(v))})}:n.toBlob=function(f,v,E){var p=this;setTimeout(function(){f(y(p.toDataURL(v,E)))})})),i.exports?i.exports=y:e.dataURLtoBlob=y}(window)}),Te=function(e){return typeof Blob=="undefined"?!1:e instanceof Blob||Object.prototype.toString.call(e)==="[object Blob]"},k={strict:!0,checkOrientation:!0,maxWidth:Infinity,maxHeight:Infinity,minWidth:0,minHeight:0,width:void 0,height:void 0,quality:.8,mimeType:"auto",convertSize:5e6,beforeDraw:null,drew:null,success:null,error:null},Ie=typeof window!="undefined"&&typeof window.document!="undefined",X=Ie?window:{},G=Array.prototype.slice;function oe(i){return Array.from?Array.from(i):G.call(i)}var U=/^image\/.+$/;function I(i){return U.test(i)}function Pe(i){var e=I(i)?i.substr(6):"";return e==="jpeg"&&(e="jpg"),".".concat(e)}var xe=String.fromCharCode;function Ze(i,e,n){var r="",c;for(n+=e,c=e;c<n;c+=1)r+=xe(i.getUint8(c));return r}var Ee=X.btoa;function Me(i,e){for(var n=[],r=8192,c=new Uint8Array(i);c.length>0;)n.push(xe.apply(null,oe(c.subarray(0,r)))),c=c.subarray(r);return"data:".concat(e,";base64,").concat(Ee(n.join("")))}function h(i){var e=new DataView(i),n;try{var r,c,t;if(e.getUint8(0)===255&&e.getUint8(1)===216)for(var C=e.byteLength,y=2;y+1<C;){if(e.getUint8(y)===255&&e.getUint8(y+1)===225){c=y;break}y+=1}if(c){var f=c+4,v=c+10;if(Ze(e,f,4)==="Exif"){var E=e.getUint16(v);if(r=E===18761,(r||E===19789)&&e.getUint16(v+2,r)===42){var p=e.getUint32(v+4,r);p>=8&&(t=v+p)}}}if(t){var D=e.getUint16(t,r),T,m;for(m=0;m<D;m+=1)if(T=t+m*12+2,e.getUint16(T,r)===274){T+=8,n=e.getUint16(T,r),e.setUint16(T,1,r);break}}}catch(Z){n=1}return n}function l(i){var e=0,n=1,r=1;switch(i){case 2:n=-1;break;case 3:e=-180;break;case 4:r=-1;break;case 5:e=90,r=-1;break;case 6:e=90;break;case 7:e=90,n=-1;break;case 8:e=-90;break}return{rotate:e,scaleX:n,scaleY:r}}var x=/\.\d*(?:0|9){12}\d*$/;function o(i){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return x.test(i)?Math.round(i*e)/e:i}var g=X.ArrayBuffer,$=X.FileReader,L=X.URL||X.webkitURL,ne=/\.\w+$/,re=X.Compressor,ie=function(){function i(e,n){B(this,i),this.file=e,this.image=new Image,this.options=ae(ae({},k),n),this.aborted=!1,this.result=null,this.init()}return b(i,[{key:"init",value:function(){var n=this,r=this.file,c=this.options;if(!Te(r)){this.fail(new Error("The first argument must be a File or Blob object."));return}var t=r.type;if(!I(t)){this.fail(new Error("The first argument must be an image File or Blob object."));return}if(!L||!$){this.fail(new Error("The current browser does not support image compression."));return}if(g||(c.checkOrientation=!1),L&&!c.checkOrientation)this.load({url:L.createObjectURL(r)});else{var C=new $,y=c.checkOrientation&&t==="image/jpeg";this.reader=C,C.onload=function(f){var v=f.target,E=v.result,p={};if(y){var D=h(E);D>1||!L?(p.url=Me(E,t),D>1&&s(p,l(D))):p.url=L.createObjectURL(r)}else p.url=E;n.load(p)},C.onabort=function(){n.fail(new Error("Aborted to read the image with FileReader."))},C.onerror=function(){n.fail(new Error("Failed to read the image with FileReader."))},C.onloadend=function(){n.reader=null},y?C.readAsArrayBuffer(r):C.readAsDataURL(r)}}},{key:"load",value:function(n){var r=this,c=this.file,t=this.image;t.onload=function(){r.draw(ae(ae({},n),{},{naturalWidth:t.naturalWidth,naturalHeight:t.naturalHeight}))},t.onabort=function(){r.fail(new Error("Aborted to load the image."))},t.onerror=function(){r.fail(new Error("Failed to load the image."))},X.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(X.navigator.userAgent)&&(t.crossOrigin="anonymous"),t.alt=c.name,t.src=n.url}},{key:"draw",value:function(n){var r=this,c=n.naturalWidth,t=n.naturalHeight,C=n.rotate,y=C===void 0?0:C,f=n.scaleX,v=f===void 0?1:f,E=n.scaleY,p=E===void 0?1:E,D=this.file,T=this.image,m=this.options,Z=document.createElement("canvas"),j=Z.getContext("2d"),O=c/t,me=Math.abs(y)%180==90,w=Math.max(m.maxWidth,0)||Infinity,K=Math.max(m.maxHeight,0)||Infinity,A=Math.max(m.minWidth,0)||0,z=Math.max(m.minHeight,0)||0,M=Math.max(m.width,0)||c,d=Math.max(m.height,0)||t;if(me){var F=[K,w];w=F[0],K=F[1];var u=[z,A];A=u[0],z=u[1];var P=[d,M];M=P[0],d=P[1]}w<Infinity&&K<Infinity?K*O>w?K=w/O:w=K*O:w<Infinity?K=w/O:K<Infinity&&(w=K*O),A>0&&z>0?z*O>A?z=A/O:A=z*O:A>0?z=A/O:z>0&&(A=z*O),d*O>M?d=M/O:M=d*O,M=Math.floor(o(Math.min(Math.max(M,A),w))),d=Math.floor(o(Math.min(Math.max(d,z),K)));var Y=-M/2,S=-d/2,R=M,V=d;if(me){var _=[d,M];M=_[0],d=_[1]}Z.width=M,Z.height=d,I(m.mimeType)||(m.mimeType=D.type);var q="transparent";if(D.size>m.convertSize&&m.mimeType==="image/png"&&(q="#fff",m.mimeType="image/jpeg"),j.fillStyle=q,j.fillRect(0,0,M,d),m.beforeDraw&&m.beforeDraw.call(this,j,Z),!this.aborted&&(j.save(),j.translate(M/2,d/2),j.rotate(y*Math.PI/180),j.scale(v,p),j.drawImage(T,Y,S,R,V),j.restore(),m.drew&&m.drew.call(this,j,Z),!this.aborted)){var se=function(le){r.aborted||r.done({naturalWidth:c,naturalHeight:t,result:le})};Z.toBlob?Z.toBlob(se,m.mimeType,m.quality):se(be(Z.toDataURL(m.mimeType,m.quality)))}}},{key:"done",value:function(n){var r=n.naturalWidth,c=n.naturalHeight,t=n.result,C=this.file,y=this.image,f=this.options;if(L&&!f.checkOrientation&&L.revokeObjectURL(y.src),t)if(f.strict&&t.size>C.size&&f.mimeType===C.type&&!(f.width>r||f.height>c||f.minWidth>r||f.minHeight>c))t=C;else{var v=new Date;t.lastModified=v.getTime(),t.lastModifiedDate=v,t.name=C.name,t.name&&t.type!==C.type&&(t.name=t.name.replace(ne,Pe(t.type)))}else t=C;this.result=t,f.success&&f.success.call(this,t)}},{key:"fail",value:function(n){var r=this.options;if(r.error)r.error.call(this,n);else throw n}},{key:"abort",value:function(){this.aborted||(this.aborted=!0,this.reader?this.reader.abort():this.image.complete?this.fail(new Error("The compression process has been aborted.")):(this.image.onload=null,this.image.onabort()))}}],[{key:"noConflict",value:function(){return window.Compressor=re,i}},{key:"setDefaults",value:function(n){s(k,n)}}]),i}();return ie})}}]);
