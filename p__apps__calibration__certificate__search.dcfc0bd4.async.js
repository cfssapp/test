(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[569],{25047:function(ve,E,t){"use strict";t.r(E),t.d(E,{default:function(){return ce}});var be=t(57338),N=t(25084),Fe=t(57663),S=t(71577),j=t(2824),T=t(8870),ye=t(34792),g=t(48086),f=t(3182),O=t(94043),n=t.n(O),G=t(76570),F=t(67294),d=t(97363),z=t(75362),K=t(85224),J=t(44957),Q=t(37476),D=t(5966),H=t(90672),X=t(12826),Me=t(71194),k=t(57016),w=t(3843),C=t(64317),q=t(86615),_=t(22452),e=t(85893),ee=function(l){var s=(0,d.YB)();return(0,e.jsxs)(w.Z,{stepsProps:{size:"small"},stepsFormRender:function(v,a){return(0,e.jsx)(k.Z,{width:640,bodyStyle:{padding:"32px 40px 48px"},destroyOnClose:!0,title:s.formatMessage({id:"pages.searchTable.updateForm.ruleConfig",defaultMessage:"\u89C4\u5219\u914D\u7F6E"}),visible:l.updateModalVisible,footer:a,onCancel:function(){l.onCancel()},children:v})},onFinish:l.onSubmit,children:[(0,e.jsxs)(w.Z.StepForm,{initialValues:{name:l.values.name,desc:l.values.desc},title:s.formatMessage({id:"pages.searchTable.updateForm.basicConfig",defaultMessage:"\u57FA\u672C\u4FE1\u606F"}),children:[(0,e.jsx)(D.Z,{name:"name",label:s.formatMessage({id:"pages.searchTable.updateForm.ruleName.nameLabel",defaultMessage:"\u89C4\u5219\u540D\u79F0"}),width:"md",rules:[{required:!0,message:(0,e.jsx)(d._H,{id:"pages.searchTable.updateForm.ruleName.nameRules",defaultMessage:"\u8BF7\u8F93\u5165\u89C4\u5219\u540D\u79F0\uFF01"})}]}),(0,e.jsx)(H.Z,{name:"desc",width:"md",label:s.formatMessage({id:"pages.searchTable.updateForm.ruleDesc.descLabel",defaultMessage:"\u89C4\u5219\u63CF\u8FF0"}),placeholder:s.formatMessage({id:"pages.searchTable.updateForm.ruleDesc.descPlaceholder",defaultMessage:"\u8BF7\u8F93\u5165\u81F3\u5C11\u4E94\u4E2A\u5B57\u7B26"}),rules:[{required:!0,message:(0,e.jsx)(d._H,{id:"pages.searchTable.updateForm.ruleDesc.descRules",defaultMessage:"\u8BF7\u8F93\u5165\u81F3\u5C11\u4E94\u4E2A\u5B57\u7B26\u7684\u89C4\u5219\u63CF\u8FF0\uFF01"}),min:5}]})]}),(0,e.jsxs)(w.Z.StepForm,{initialValues:{target:"0",template:"0"},title:s.formatMessage({id:"pages.searchTable.updateForm.ruleProps.title",defaultMessage:"\u914D\u7F6E\u89C4\u5219\u5C5E\u6027"}),children:[(0,e.jsx)(C.Z,{name:"target",width:"md",label:s.formatMessage({id:"pages.searchTable.updateForm.object",defaultMessage:"\u76D1\u63A7\u5BF9\u8C61"}),valueEnum:{0:"\u8868\u4E00",1:"\u8868\u4E8C"}}),(0,e.jsx)(C.Z,{name:"template",width:"md",label:s.formatMessage({id:"pages.searchTable.updateForm.ruleProps.templateLabel",defaultMessage:"\u89C4\u5219\u6A21\u677F"}),valueEnum:{0:"\u89C4\u5219\u6A21\u677F\u4E00",1:"\u89C4\u5219\u6A21\u677F\u4E8C"}}),(0,e.jsx)(q.Z.Group,{name:"type",label:s.formatMessage({id:"pages.searchTable.updateForm.ruleProps.typeLabel",defaultMessage:"\u89C4\u5219\u7C7B\u578B"}),options:[{value:"0",label:"\u5F3A"},{value:"1",label:"\u5F31"}]})]}),(0,e.jsxs)(w.Z.StepForm,{initialValues:{type:"1",frequency:"month"},title:s.formatMessage({id:"pages.searchTable.updateForm.schedulingPeriod.title",defaultMessage:"\u8BBE\u5B9A\u8C03\u5EA6\u5468\u671F"}),children:[(0,e.jsx)(_.Z,{name:"time",width:"md",label:s.formatMessage({id:"pages.searchTable.updateForm.schedulingPeriod.timeLabel",defaultMessage:"\u5F00\u59CB\u65F6\u95F4"}),rules:[{required:!0,message:(0,e.jsx)(d._H,{id:"pages.searchTable.updateForm.schedulingPeriod.timeRules",defaultMessage:"\u8BF7\u9009\u62E9\u5F00\u59CB\u65F6\u95F4\uFF01"})}]}),(0,e.jsx)(C.Z,{name:"frequency",label:s.formatMessage({id:"pages.searchTable.updateForm.object",defaultMessage:"\u76D1\u63A7\u5BF9\u8C61"}),width:"md",valueEnum:{month:"\u6708",week:"\u5468"}})]})]})},ae=ee;function re(u){return R.apply(this,arguments)}function R(){return R=(0,f.Z)(n().mark(function u(l){return n().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,d.WY)("https://antapi.pythonanywhere.com/calibration/certificate/",{method:"GET",headers:{"Content-Type":"application/json",Authorization:"JWT "+localStorage.getItem("access_token")},params:{search:l.category}}));case 1:case"end":return r.stop()}},u)})),R.apply(this,arguments)}function se(u){return x.apply(this,arguments)}function x(){return x=(0,f.Z)(n().mark(function u(l){return n().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,d.WY)("/api/rule",(0,T.Z)({method:"PUT"},l||{})));case 1:case"end":return r.stop()}},u)})),x.apply(this,arguments)}function te(u){return P.apply(this,arguments)}function P(){return P=(0,f.Z)(n().mark(function u(l){return n().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,d.WY)("/api/rule",(0,T.Z)({method:"POST"},l||{})));case 1:case"end":return r.stop()}},u)})),P.apply(this,arguments)}function ne(u){return $.apply(this,arguments)}function $(){return $=(0,f.Z)(n().mark(function u(l){return n().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,d.WY)("/api/rule",(0,T.Z)({method:"DELETE"},l||{})));case 1:case"end":return r.stop()}},u)})),$.apply(this,arguments)}var le=function(){var u=(0,f.Z)(n().mark(function l(s){var r;return n().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return r=g.default.loading("\u6B63\u5728\u6DFB\u52A0"),a.prev=1,a.next=4,te((0,T.Z)({},s));case 4:return r(),g.default.success("Added successfully"),a.abrupt("return",!0);case 9:return a.prev=9,a.t0=a.catch(1),r(),g.default.error("Adding failed, please try again!"),a.abrupt("return",!1);case 14:case"end":return a.stop()}},l,null,[[1,9]])}));return function(s){return u.apply(this,arguments)}}(),ue=function(){var u=(0,f.Z)(n().mark(function l(s){var r;return n().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return r=g.default.loading("Configuring"),a.prev=1,a.next=4,se({name:s.name,desc:s.desc,key:s.key});case 4:return r(),g.default.success("Configuration is successful"),a.abrupt("return",!0);case 9:return a.prev=9,a.t0=a.catch(1),r(),g.default.error("Configuration failed, please try again!"),a.abrupt("return",!1);case 14:case"end":return a.stop()}},l,null,[[1,9]])}));return function(s){return u.apply(this,arguments)}}(),ie=function(){var u=(0,f.Z)(n().mark(function l(s){var r;return n().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(r=g.default.loading("\u6B63\u5728\u5220\u9664"),s){a.next=3;break}return a.abrupt("return",!0);case 3:return a.prev=3,a.next=6,ne({key:s.map(function(Z){return Z.key})});case 6:return r(),g.default.success("Deleted successfully and will refresh soon"),a.abrupt("return",!0);case 11:return a.prev=11,a.t0=a.catch(3),r(),g.default.error("Delete failed, please try again"),a.abrupt("return",!1);case 16:case"end":return a.stop()}},l,null,[[3,11]])}));return function(s){return u.apply(this,arguments)}}(),de=function(){var l=(0,F.useState)(!1),s=(0,j.Z)(l,2),r=s[0],v=s[1],a=(0,F.useState)(!1),Z=(0,j.Z)(a,2),oe=Z[0],B=Z[1],pe=(0,F.useState)(!1),V=(0,j.Z)(pe,2),L=V[0],fe=V[1],y=(0,F.useRef)(),me=(0,F.useState)(),I=(0,j.Z)(me,2),m=I[0],A=I[1],he=(0,F.useState)([]),U=(0,j.Z)(he,2),M=U[0],ge=U[1],W=(0,d.YB)(),Y=[{title:"Certificate",dataIndex:"certificate_id",sorter:!0},{title:"Instrument",dataIndex:"instrument",sorter:!0,hideInSearch:!0},{title:(0,e.jsx)(d._H,{id:"pages.searchTable.titleOption",defaultMessage:"Operating"}),dataIndex:"option",valueType:"option",render:function(i,c){return[(0,e.jsx)("a",{onClick:function(){localStorage.setItem("topic_id",c.id),d.m8.push("/calibration/certificate/details")},children:(0,e.jsx)(S.Z,{shape:"circle",icon:(0,e.jsx)(G.Z,{})})},"config")]}}];return(0,e.jsxs)(z.ZP,{children:[(0,e.jsx)(J.ZP,{headerTitle:W.formatMessage({id:"pages.searchTable.title2",defaultMessage:"Results"}),actionRef:y,rowKey:function(i,c){return"complete".concat(i.id).concat(c)},search:{labelWidth:120},request:function(){var p=(0,f.Z)(n().mark(function i(c){var h;return n().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,re(c);case 2:return h=o.sent,o.abrupt("return",Promise.resolve({data:h,success:!0}));case 4:case"end":return o.stop()}},i)}));return function(i){return p.apply(this,arguments)}}(),columns:Y}),(M==null?void 0:M.length)>0&&(0,e.jsxs)(K.Z,{extra:(0,e.jsxs)("div",{children:[(0,e.jsx)(d._H,{id:"pages.searchTable.chosen",defaultMessage:"Chosen"})," ",(0,e.jsx)("a",{style:{fontWeight:600},children:M.length})," ",(0,e.jsx)(d._H,{id:"pages.searchTable.item",defaultMessage:"\u9879"}),"\xA0\xA0",(0,e.jsxs)("span",{children:[(0,e.jsx)(d._H,{id:"pages.searchTable.totalServiceCalls",defaultMessage:"Total number of service calls"})," ",M.reduce(function(p,i){return p+i.callNo},0)," ",(0,e.jsx)(d._H,{id:"pages.searchTable.tenThousand",defaultMessage:"\u4E07"})]})]}),children:[(0,e.jsx)(S.Z,{onClick:(0,f.Z)(n().mark(function p(){var i,c;return n().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,ie(M);case 2:ge([]),(i=y.current)===null||i===void 0||(c=i.reloadAndRest)===null||c===void 0||c.call(i);case 4:case"end":return b.stop()}},p)})),children:(0,e.jsx)(d._H,{id:"pages.searchTable.batchDeletion",defaultMessage:"Batch deletion"})}),(0,e.jsx)(S.Z,{type:"primary",children:(0,e.jsx)(d._H,{id:"pages.searchTable.batchApproval",defaultMessage:"Batch approval"})})]}),(0,e.jsxs)(Q.Z,{title:W.formatMessage({id:"pages.searchTable.createForm.newRule",defaultMessage:"New rule"}),width:"400px",visible:r,onVisibleChange:v,onFinish:function(){var p=(0,f.Z)(n().mark(function i(c){var h;return n().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,le(c);case 2:h=o.sent,h&&(v(!1),y.current&&y.current.reload());case 4:case"end":return o.stop()}},i)}));return function(i){return p.apply(this,arguments)}}(),children:[(0,e.jsx)(D.Z,{rules:[{required:!0,message:(0,e.jsx)(d._H,{id:"pages.searchTable.ruleName",defaultMessage:"Rule name is required"})}],width:"md",name:"name"}),(0,e.jsx)(H.Z,{width:"md",name:"desc"})]}),(0,e.jsx)(ae,{onSubmit:function(){var p=(0,f.Z)(n().mark(function i(c){var h;return n().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,ue(c);case 2:h=o.sent,h&&(B(!1),A(void 0),y.current&&y.current.reload());case 4:case"end":return o.stop()}},i)}));return function(i){return p.apply(this,arguments)}}(),onCancel:function(){B(!1),L||A(void 0)},updateModalVisible:oe,values:m||{}}),(0,e.jsx)(N.Z,{width:600,visible:L,onClose:function(){A(void 0),fe(!1)},closable:!1,children:(m==null?void 0:m.name)&&(0,e.jsx)(X.Z,{column:2,title:m==null?void 0:m.name,request:(0,f.Z)(n().mark(function p(){return n().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",{data:m||{}});case 1:case"end":return c.stop()}},p)})),params:{id:m==null?void 0:m.name},columns:Y})})]})},ce=de}}]);
